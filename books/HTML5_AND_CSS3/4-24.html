<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- meta使用viewport以确保页面可自由缩放 -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>4-24</title>
</head>

<body>
    <p>
        <label for="">
        选择一个文件：
        </label>
        <input type="file" id="file">
        <input type="button" value="读取图像" onclick="readAsDataURL()">
        <input type="button" value="读取二进制数据" onclick="readAsBinaryString();">
        <input type="button" value="读取文本文件" onclick="readAsText();">
    </p>
    <div id="result">
    	
    </div>
    <script>
    	var result=document.getElementById("result");
    	var file = document.getElementById("file");
    	if(typeof FileReader == 'undefined'){
    		result.innerHTML = "<p>抱歉，您的浏览器不支持FileReader<p/>";
    		file.setAttribute("disabled","disabled");
    	}
    	function readAsDataURL(){
    		var file=document.getElementById("file").files[0];
    		if(!/image\/\w+/.test(file.type)){
    			alert("请确保文件为图像类型");
    			return false;
    		}
    		var reader = new FileReader();
    		reader.readAsDataURL(file);
    		reader.onload = function(e){
    				var result=document.getElementById("result");
    				result.innerHTML = "<img src='"+this.result+"'>";
    		}
    	}
    	function readAsBinaryString(){
    		var file=document.getElementById("file").files[0];
    		var reader = new FileReader();
    		reader.readAsBinaryString(file);
    		reader.onload = function(f){
    				var result=document.getElementById("result");
    				result.innerHTML =this.result;
    		}
    	}
    	function readAsText(){
    		var file=document.getElementById("file").files[0];
    		var reader = new FileReader();
    		reader.readAsText(file);
    		reader.onload = function(f){
    				var result=document.getElementById("result");
    				result.innerHTML =this.result;
    		}
    	}
    </script>
</body>

</html>
